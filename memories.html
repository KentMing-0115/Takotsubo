<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Memories Together</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            font-family: Arial, Helvetica, sans-serif;
            text-align: center;
        }

        #board {
            width: 243px;
            height: 243px;
            border: 2px solid blue;
            margin: 0 auto;
            display: flex;
            flex-wrap: wrap;
        }

        #board img {
            width: 79px;
            height: 79px;
            border: 0.5px solid lightblue;
        }

        #pieces {
            width: 715px;
            height: 85px;
            border: 2px solid blue;
            margin: 0 auto;
            display: flex;
            flex-wrap: wrap;
        }

        #pieces img {
            width: 79px;
            height: 79px;
            border: 0.5px solid lightblue;
        }
    </style>
</head>

<body>
    <br>
    <div id="board"></div>
    <br><br><br>
    <div id="pieces"></div>
    <br>
    <button class="btn btn-success btn-lg start-btn" onclick="checkSolution()">Done</button>
    <button class="btn btn-success btn-lg start-btn" onclick="resetPuzzle()">Reset</button>

    <script>
        const gridSize = 3;
        let selectedTile = null;
        let targetTile = null;

        window.onload = function () {
            createBoard();
            shufflePieces();
        };

        function createBoard() {
            for (let row = 0; row < gridSize; row++) {
                for (let col = 0; col < gridSize; col++) {
                    let tile = document.createElement("img");
                    tile.src = "images/blank.jpg";
                    addDragEvents(tile);
                    document.getElementById("board").append(tile);
                }
            }
        }

        function shufflePieces() {
            let pieces = Array.from({ length: gridSize * gridSize }, (_, i) => (i + 1).toString());
            pieces.sort(() => Math.random() - 0.5);

            pieces.forEach(piece => {
                let tile = document.createElement("img");
                tile.src = `images/${piece}.jpg`;
                addDragEvents(tile);
                document.getElementById("pieces").append(tile);
            });
        }

        function addDragEvents(tile) {
            tile.addEventListener("dragstart", onDragStart);
            tile.addEventListener("dragover", event => event.preventDefault());
            tile.addEventListener("dragenter", event => event.preventDefault());
            tile.addEventListener("drop", onDrop);
            tile.addEventListener("dragend", onDragEnd);
        }

        function onDragStart() {
            selectedTile = this;
        }

        function onDrop() {
            targetTile = this;
        }

        function onDragEnd() {
            if (!selectedTile.src.includes("blank")) {
                [selectedTile.src, targetTile.src] = [targetTile.src, selectedTile.src];
            }
        }

        function checkSolution() {
            let tiles = document.querySelectorAll("#board img");
            for (let i = 0; i < tiles.length; i++) {
                let expectedSrc = "images/" + (i + 1) + ".jpg";
                if (!tiles[i].src.includes(expectedSrc)) {
                    alert("Try Again!");
                    return;
                }
            }
            alert("Puzzle Completed!");
        }

        function resetPuzzle() {
            document.getElementById("board").innerHTML = "";
            document.getElementById("pieces").innerHTML = "";
            createBoard();
            shufflePieces();
        }
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>